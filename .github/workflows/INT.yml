
name: YouTube Download via Tor (No DNS Leak)

on:
  workflow_dispatch:

jobs:
  download-video:
    runs-on: ubuntu-latest

    steps:
    - name: Install Dependencies
      run: |
        sudo apt update
        sudo apt install -y tor torsocks curl yt-dlp

    - name: Start Tor Service
      run: |
        sudo service tor start
        sleep 10  # Wait for Tor to start

    - name: Test Tor IP
      run: |
        torsocks curl -s https://ifconfig.me > tor_ip.txt
        echo "Your Tor IP: $(cat tor_ip.txt)"

    - name: Test DNS Leak
      run: |
        torsocks curl -s https://dnsleaktest.com > dns_test.txt
        echo "DNS Test Results: $(cat dns_test.txt)"

    - name: Download YouTube Video via Tor
      run: |
        torsocks yt-dlp -o "video.mp4" "https://www.youtube.com/watch?v=VIDEO_ID"

    - name: Upload Video as Artifact
      uses: actions/upload-artifact@v4
      with:
        name: youtube-video
        path: video.mp4
