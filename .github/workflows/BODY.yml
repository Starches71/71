
name: Remove Person from Video

on:
  workflow_dispatch:

jobs:
  remove-person:
    runs-on: ubuntu-latest

    steps:
      - name: ğŸ“¥ Checkout Repository
        uses: actions/checkout@v3

      - name: ğŸ Set Up Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.10'

      - name: ğŸ“¦ Install Dependencies
        run: |
          python -m pip install --upgrade pip
          pip install lama-cleaner opencv-python-headless numpy

      - name: ğŸï¸ Extract Video Frames
        run: |
          mkdir -p frames
          ffmpeg -i "iPhone_16_Pro_Max_VS_S24_Ultra_-_Ultimate_selfie_test!(360p).mp4" frames/frame_%04d.png

      - name: ğŸ–¼ï¸ Process Frames with Lama Cleaner
        run: |
          mkdir -p processed_frames
          for frame in frames/*.png; do
            # Replace this command with the actual Lama Cleaner processing command
            # For example, if Lama Cleaner has a CLI command like:
            # lama-cleaner --input $frame --output processed_frames/$(basename $frame) --model lama --device cpu
            echo "Processing $frame"
            cp "$frame" "processed_frames/$(basename $frame)"  # Placeholder for actual processing
          done

      - name: ğŸ¬ Reassemble Processed Frames into Video
        run: |
          ffmpeg -framerate 30 -i processed_frames/frame_%04d.png -c:v libx264 -pix_fmt yuv420p output/no_person.mp4

      - name: ğŸ“¤ Upload Processed Video
        uses: actions/upload-artifact@v4
        with:
          name: no_person_video
          path: output/no_person.mp4
