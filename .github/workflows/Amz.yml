
name: Clean Product Names

on:
  schedule:
    - cron: '0 0 * * *'  # This will run the workflow every day at midnight UTC
  workflow_dispatch:  # This allows you to manually trigger the workflow if needed
    inputs:
      trigger:
        description: 'Trigger cleaning process'
        required: false
        default: 'true'

jobs:
  clean-product-names:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout repository
      uses: actions/checkout@v2

    - name: Set up Python
      uses: actions/setup-python@v2
      with:
        python-version: '3.x'

    - name: Install required dependencies
      run: |
        python -m pip install --upgrade pip
        pip install -r requirements.txt || echo "No requirements.txt found"

    - name: Clean product names
      run: |
        # Read the amazon.txt file and clean product names
        python -c "
import re

# Read the file and remove numbers and unwanted elements
with open('amazon.txt', 'r') as f:
    lines = f.readlines()

# Remove the numbers and clean the lines
cleaned_lines = []
for line in lines:
    cleaned_line = re.sub(r'^\d+\.', '', line).strip()  # Remove numbers at the start of the line
    if cleaned_line and cleaned_line not in cleaned_lines:
        cleaned_lines.append(cleaned_line)

# Write the cleaned product names to amz.txt
with open('amz.txt', 'w') as f:
    for line in cleaned_lines:
        f.write(line + '\n')
        "

    - name: Commit and push changes
      uses: EndBug/add-and-commit@v7
      with:
        author_name: 'GitHub Actions'
        author_email: 'actions@github.com'
        message: 'Clean product names and remove duplicates'
        add: 'amz.txt'
